
# ExcelService - Сервис для обработки данных из XLSX-файлов

Этот проект реализует сервис для обработки данных из XLSX-файлов, включая поиск N-го максимального числа в файле.

## Описание

`ExcelService` предоставляет функционал для обработки числовых данных в формате XLSX. С помощью метода `findNthMax` можно найти N-ое максимальное число в файле. Для выполнения поиска используется приоритетная очередь (min-heap).

### Основной функционал:

- Чтение данных из XLSX файла.
- Поиск N-го максимального числа в списке чисел, считанных из файла.
- Обработка ошибок чтения файла и некорректных данных.

## Стек технологий

- Java 17
- Spring Boot
- Apache POI (для работы с XLSX)
- JUnit 5 (для тестирования)

## Установка и запуск

### 1. Клонирование репозитория:

```bash
git clone https://github.com/ваш-репозиторий.git
cd ваш-репозиторий
```

### 2. Сборка и запуск:

Проект использует Gradle, так что вы можете собрать и запустить его с помощью следующей команды:

```bash
./gradlew build
./gradlew bootRun
```

### 3. Запуск через Docker

Для удобства развертывания проекта в Docker, вы можете использовать `Dockerfile`, который создаст контейнер с вашим приложением.

#### Шаги для запуска:

1. Соберите Docker-образ:
   ```bash
   docker build -t excel-service .
   ```

2. Запустите контейнер:
   ```bash
   docker run -p 8080:8080 excel-service
   ```

Теперь сервис будет доступен по адресу `http://localhost:8080`.

### 4. Настройки

Параметры конфигурации можно указать в `application.properties`, например:

```properties
priority.queue.size=100
```

### 5. Пример запроса

Для получения N-го максимального числа из файла, можно отправить GET-запрос:

```bash
curl -X GET "http://localhost:8080/max-number" -H "Content-Type: application/json" -d '{"filePath":"/path/to/your/file.xlsx", "n":3}'
```

Ответ будет содержать N-е максимальное число из файла.

## Документация API с помощью Swagger

Swagger автоматически генерирует документацию для всех доступных API-методов, их параметров и примеров использования.

Для просмотра документации API с использованием Swagger, просто запустите приложение и откройте браузер по следующему адресу:
http://localhost:8080/swagger-ui/


## Тестирование

В проекте предусмотрены юнит-тесты с использованием JUnit 5. Чтобы запустить все тесты, используйте команду:

```bash
./gradlew test
```

## Ошибки и исключения

- Если в файле недостаточно чисел для поиска, метод выбросит исключение `IllegalArgumentException`.
- При ошибках чтения файла будет выброшено исключение `FileProcessingException`.
